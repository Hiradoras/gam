<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İnteraktif Gam ve Akor Bulucu</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: #f8f9fa;
            color: #212529;
            margin: 0;
            padding: 20px;
        }
       .container {
            max-width: 900px;
            margin: auto;
            background: #ffffff;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #343a40;
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 10px;
        }
       .selection-area {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
       .selection-box {
            flex: 1;
            min-width: 250px;
        }
       .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
       .btn, select {
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            background-color: #e9ecef;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s, box-shadow 0.2s;
        }
       .btn:hover, select:hover {
            background-color: #dee2e6;
        }
       .btn.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }
        select {
            width: 100%;
        }
        #scale-list {
            margin-top: 20px;
        }
       .scale-item {
            display: block;
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 5px;
            background: #f1f3f5;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            text-align: left;
            cursor: pointer;
        }
       .scale-item:hover {
            background: #e9ecef;
        }
        #results {
            margin-top: 25px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            background-color: #fff;
        }
        #results h3 {
            margin-top: 0;
            color: #007bff;
        }
       .result-section {
            margin-bottom: 20px;
        }
       .result-section h4 {
            margin-bottom: 8px;
            color: #495057;
        }
       .result-section p,.result-section div {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.95rem;
        }
        pre {
            background-color: #212529;
            color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: "Courier New", Courier, monospace;
            font-size: 0.9rem;
        }
       .chords-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
       .chord-box {
            background-color: #e9ecef;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            border: 1px solid #ced4da;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .chord-box:hover {
            background-color: #d1d9e0;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: #fff;
            padding: 20px 30px;
            border-radius: 8px;
            min-width: 320px;
            text-align: center;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #888;
        }
        .modal-close:hover {
            color: #000;
        }
        #modal-chord-diagram {
            font-size: 1rem;
            line-height: 1.4;
            text-align: left;
            background-color: #fff;
            color: #212529;
            padding: 0;
            border: none;
            white-space: pre;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>İnteraktif Gam ve Akor Bulucu</h1>
    <p>Müziğinizi şekillendirmek için notaları, gamları ve duyguları keşfedin.</p>

    <div class="selection-area">
        <div class="selection-box">
            <h2>1. Nota'ya Göre Keşfet</h2>
            <div id="note-selector" class="controls"></div>
        </div>
        <div class="selection-box">
            <h2>1. Duygu'ya Göre Keşfet</h2>
            <select id="mood-selector" class="controls">
                <option value="">Psikolojik Ton Seçin...</option>
            </select>
        </div>
    </div>

    <div id="scale-list-container" style="display:none;">
        <h2>2. Gam veya Mod Seçin</h2>
        <div id="scale-list" class="controls"></div>
    </div>

    <div id="results" style="display:none;"></div>
</div>

<!-- Chord Diagram Modal -->
<div id="chord-modal" class="modal-overlay" style="display:none;" onclick="closeChordModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <span class="modal-close" onclick="closeChordModal()">&times;</span>
        <h3 id="modal-chord-name"></h3>
        <pre id="modal-chord-diagram"></pre>
    </div>
</div>


<script>
    const notes = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    const noteNames = {
        "C": "Do", "C#": "Do#", "D": "Re", "D#": "Re#", "E": "Mi", "F": "Fa", 
        "F#": "Fa#", "G": "Sol", "G#": "Sol#", "A": "La", "A#": "La#", "B": "Si"
    };

    const scaleData = {
        'ionian': { 
            name: 'Ionian (Majör Gam)', 
            intervals: [2, 2, 1, 2, 2, 2, 1], 
            intervalStr: 'T-T-Y-T-T-T-Y',
            chords: ['Majör', 'minör', 'minör', 'Majör', 'Majör', 'minör', 'Eksiltilmiş'],
            mood: 'Neşeli, mutlu, kararlı, tanıdık',
            exampleSong: 'The Beatles - "Here Comes the Sun"',
            tab: `Pozisyon 1 (Kök ses 6. tel, 8. perde C için)\ne|---------------------------------7-8-10-|\nB|---------------------------8-10---------|\nG|---------------------7-9-10-------------|\nD|---------------7-9-10-------------------|\nA|---------7-8-10-------------------------|\nE|---8-10---------------------------------|`
        },
        'aeolian': { 
            name: 'Aeolian (Doğal Minör)', 
            intervals: [2, 1, 2, 2, 1, 2, 2], 
            intervalStr: 'T-Y-T-T-Y-T-T',
            chords: ['minör', 'Eksiltilmiş', 'Majör', 'minör', 'minör', 'Majör', 'Majör'],
            mood: 'Hüzünlü, melankolik, romantik, içe dönük',
            exampleSong: 'R.E.M. - "Losing My Religion"',
            tab: `Pozisyon 1 (Kök ses 6. tel, 5. perde A için)\ne|---------------------------------5-7-8-|\nB|---------------------------5-6-8-------|\nG|---------------------4-5-7-------------|\nD|---------------5-7-9-------------------|\nA|---------5-7-8-------------------------|\nE|---5-7-8-------------------------------|`
        },
        'harmonic_minor': {
            name: 'Armonik Minör',
            intervals: [2, 1, 2, 2, 1, 3, 1],
            intervalStr: 'T-Y-T-T-Y-T½-Y',
            chords: ['minör', 'Eksiltilmiş', 'Artırılmış', 'minör', 'Majör', 'Majör', 'Eksiltilmiş'],
            mood: 'Gergin, dramatik, oryantal, klasik',
            exampleSong: 'D.A.D. - "Sleeping My Day Away" (Solo)',
            tab: `Doğal minör kalıbındaki 7. notayı yarım ses tizleştirin.\nÖrnek A Armonik Minör (G# notası eklenir):\ne|---------------------------------5-7-8-|\nB|---------------------------5-6-9-------|\nG|---------------------4-5-7-------------|\nD|---------------5-7-9-------------------|\nA|---------5-7-8-------------------------|\nE|---5-7-8-------------------------------|`
        },
        'melodic_minor': {
            name: 'Melodik Minör (Çıkıcı)',
            intervals: [2, 1, 2, 2, 2, 2, 1],
            intervalStr: 'T-Y-T-T-T-T-Y',
            chords: ['minör', 'minör', 'Artırılmış', 'Majör', 'Majör', 'Eksiltilmiş', 'Eksiltilmiş'],
            mood: 'Akıcı, sofistike, caz tınılı, karmaşık',
            exampleSong: 'Frank Zappa - "Watermelon in Easter Hay" (Solo)',
            tab: `Doğal minör kalıbındaki 6. ve 7. notaları yarım ses tizleştirin.\nÖrnek A Melodik Minör (F# ve G# notaları eklenir):\ne|-----------------------------------5-7-9-|\nB|-----------------------------5-7-9-------|\nG|-----------------------4-6-7-------------|\nD|-----------------5-7-9-------------------|\nA|-----------5-7-8-------------------------|\nE|---5-7-9---------------------------------|`
        },
        'dorian': { 
            name: 'Dorian', 
            intervals: [2, 1, 2, 2, 2, 1, 2], 
            intervalStr: 'T-Y-T-T-T-Y-T',
            chords: ['minör', 'minör', 'Majör', 'Majör', 'minör', 'Eksiltilmiş', 'Majör'],
            mood: 'Hüzünlü ama umutlu, "cool", caz tınılı',
            exampleSong: 'Santana - "Oye Como Va"',
            tab: `Doğal minör kalıbındaki 6. notayı yarım ses tizleştirin.\nÖrnek A Dorian (F# notası eklenir):\ne|---------------------------------5-7-9-|\nB|---------------------------5-7-8-------|\nG|---------------------4-5-7-------------|\nD|---------------5-7-9-------------------|\nA|---------5-7-8-------------------------|\nE|---5-7-8-------------------------------|`
        },
        'phrygian': { 
            name: 'Phrygian', 
            intervals: [1, 2, 2, 2, 1, 2, 2], 
            intervalStr: 'Y-T-T-T-Y-T-T',
            chords: ['minör', 'Majör', 'Majör', 'minör', 'Eksiltilmiş', 'Majör', 'minör'],
            mood: 'Egzotik, gergin, İspanyol, karanlık',
            exampleSong: 'Metallica - "Wherever I May Roam"',
            tab: `Doğal minör kalıbındaki 2. notayı yarım ses pesleştirin.\nÖrnek A Phrygian (Bb notası eklenir):\ne|---------------------------------5-7-8-|\nB|---------------------------5-6-8-------|\nG|---------------------4-5-7-------------|\nD|---------------5-7-8-------------------|\nA|---------5-6-8-------------------------|\nE|---5-7-8-------------------------------|`
        },
        'lydian': { 
            name: 'Lydian', 
            intervals: [2, 2, 2, 1, 2, 2, 1], 
            intervalStr: 'T-T-T-Y-T-T-Y',
            chords: ['Majör', 'Majör', 'minör', 'Eksiltilmiş', 'Majör', 'minör', 'minör'],
            mood: 'Rüya gibi, parlak, büyülü, ferah',
            exampleSong: 'Joe Satriani - "Flying in a Blue Dream"',
            tab: `Majör gam kalıbındaki 4. notayı yarım ses tizleştirin.\nÖrnek C Lydian (F# notası eklenir):\ne|---------------------------------7-9-10-|\nB|---------------------------8-10---------|\nG|---------------------7-9-10-------------|\nD|---------------7-9-11-------------------|\nA|---------7-8-10-------------------------|\nE|---8-10---------------------------------|`
        },
        'mixolydian': { 
            name: 'Mixolydian', 
            intervals: [2, 2, 1, 2, 2, 1, 2], 
            intervalStr: 'T-T-Y-T-T-Y-T',
            chords: ['Majör', 'minör', 'Eksiltilmiş', 'Majör', 'minör', 'minör', 'Majör'],
            mood: 'Blues\'a yakın, pozitif, enerjik, "cool"',
            exampleSong: 'Lynyrd Skynyrd - "Sweet Home Alabama"',
            tab: `Majör gam kalıbındaki 7. notayı yarım ses pesleştirin.\nÖrnek C Mixolydian (Bb notası eklenir):\ne|---------------------------------7-8-10-|\nB|---------------------------8-10-11------|\nG|---------------------7-9-10-------------|\nD|---------------7-8-10-------------------|\nA|---------7-8-10-------------------------|\nE|---8-10---------------------------------|`
        },
        'locrian': { 
            name: 'Locrian', 
            intervals: [1, 2, 2, 1, 2, 2, 2], 
            intervalStr: 'Y-T-T-Y-T-T-T',
            chords: ['Eksiltilmiş', 'Majör', 'minör', 'minör', 'Majör', 'Majör', 'minör'],
            mood: 'Kararsız, tekinsiz, karanlık, gergin',
            exampleSong: 'Nadiren kullanılır, Björk - "Army of Me" (riffin bir kısmı)',
            tab: `Doğal minör kalıbındaki 2. ve 5. notaları yarım ses pesleştirin.\nKullanımı nadirdir.`
        },
        'minor_pentatonic': {
            name: 'Minör Pentatonik',
            intervals: [3, 2, 2, 3, 2],
            intervalStr: 'T½-T-T-T½-T',
            chords: ['minör', 'Majör', 'minör', 'Majör'], // Simplified for context
            mood: 'Blues\'a yakın, sade, güçlü, rock tınılı',
            exampleSong: 'Pink Floyd - "Another Brick in the Wall, Pt. 2" (Solo)',
            tab: `Pozisyon 1 ("Blues Box" - A minör için 5. perde)\ne|---------------------5-8-|\nB|-----------------5-8-----|\nG|-------------5-7---------|\nD|---------5-7-------------|\nA|-----5-7-----------------|\nE|-5-8---------------------|`
        },
        'major_pentatonic': {
            name: 'Majör Pentatonik',
            intervals: [2, 2, 3, 2, 3],
            intervalStr: 'T-T-T½-T-T½',
            chords: ['Majör', 'minör', 'Majör', 'minör'], // Simplified for context
            mood: 'Huzurlu, neşeli, country/folk tınılı, sade',
            exampleSong: 'The Allman Brothers Band - "Jessica"',
            tab: `Pozisyon 1 (A majör için 5. perde)\ne|---------------------5-9-|\nB|-----------------5-7-----|\nG|-------------4-6---------|\nD|---------4-7-------------|\nA|-----4-7-----------------|\nE|-5-7---------------------|`
        },
        'blues': {
            name: 'Blues Gamı',
            intervals: [3, 2, 1, 1, 3, 2],
            intervalStr: 'T½-T-Y-Y-T½-T',
            chords: [], // Chords are context-dependent in blues
            mood: 'Ham, duygusal, acı-tatlı, isyankar',
            exampleSong: 'Cream - "Crossroads"',
            tab: `Minör Pentatonik + bemol 5. nota ("blue note")\nPozisyon 1 (A Blues için 5. perde)\ne|---------------------5-8-|\nB|-----------------5-8-----|\nG|-------------5-7-8-------|\nD|---------5-7-------------|\nA|-----5-6-7---------------|\nE|-5-8---------------------|`
        }
    };

    const chordFingerings = {
        'C': 'X32010', 'C#': 'X46664', 'D': 'XX0232', 'D#': 'X68886', 'E': '022100', 'F': '133211',
        'F#': '244322', 'G': '320003', 'G#': '466544', 'A': 'X02220', 'A#': 'X13331', 'B': 'X24442',
        'Cm': 'X35543', 'C#m': 'X46654', 'Dm': 'XX0231', 'D#m': 'X68876', 'Em': '022000', 'Fm': '133111',
        'F#m': '244222', 'Gm': '355333', 'G#m': '466444', 'Am': 'X02210', 'A#m': 'X13321', 'Bm': 'X24432',
        'Cdim': 'XX1212', 'C#dim': 'X4535X', 'Ddim': 'XX0131', 'D#dim': 'XX1242', 'Edim': 'XX2323', 'Fdim': '12313X',
        'F#dim': '23424X', 'Gdim': 'XX5656', 'G#dim': '45646X', 'Adim': 'X0121X', 'A#dim': 'X1232X', 'Bdim': 'X2343X',
        'Caug': 'X3211X', 'Daug': 'XX0332', 'Eaug': '032110', 'Faug': '12321X', 'Gaug': '321003', 'Aaug': 'X03221', 'Baug': 'X2100X'
    };

    const moods = {};
    for (const key in scaleData) {
        const mood = scaleData[key].mood.split(',')[0].trim();
        if (!moods[mood]) {
            moods[mood] = [];
        }
        moods[mood].push(key);
    }

    const noteSelector = document.getElementById('note-selector');
    const moodSelector = document.getElementById('mood-selector');
    const scaleListContainer = document.getElementById('scale-list-container');
    const scaleList = document.getElementById('scale-list');
    const resultsDiv = document.getElementById('results');
    const chordModal = document.getElementById('chord-modal');
    const modalChordName = document.getElementById('modal-chord-name');
    const modalChordDiagram = document.getElementById('modal-chord-diagram');

    let selectedNote = null;

    function getScaleNotes(rootNote, intervals) {
        let scale = [rootNote];
        let currentIndex = notes.indexOf(rootNote);
        for (const interval of intervals) {
            currentIndex = (currentIndex + interval) % 12;
            scale.push(notes[currentIndex]);
        }
        return scale;
    }

    function getDiatonicChords(scaleNotes, chordQualities) {
        const roman = ['I', 'II', 'III', 'IV', 'V', 'VI', 'VII'];
        const chords = [];
        if (!chordQualities) return [];
        for (let i = 0; i < 7 && i < scaleNotes.length && i < chordQualities.length; i++) {
            let note = scaleNotes[i];
            let quality = chordQualities[i];
            let chordName = '';
            switch (quality) {
                case 'Majör': chordName = `${note}`; break;
                case 'minör': chordName = `${note}m`; break;
                case 'Eksiltilmiş': chordName = `${note}dim`; break;
                case 'Artırılmış': chordName = `${note}aug`; break;
            }
            chords.push(`${roman[i]}: ${chordName}`);
        }
        return chords;
    }

    function displayScaleDetails(scaleKey) {
        if (!selectedNote) return;
        const scale = scaleData[scaleKey];
        const scaleNotes = getScaleNotes(selectedNote, scale.intervals);
        const diatonicChords = getDiatonicChords(scaleNotes, scale.chords);

        resultsDiv.innerHTML = `
            <h3>${noteNames[selectedNote]} ${scale.name}</h3>
            <div class="result-section"><h4>Bilinen Şarkı Örneği</h4><p>${scale.exampleSong}</p></div>
            <div class="result-section"><h4>Psikolojik Ton / Duygu</h4><p>${scale.mood}</p></div>
            <div class="result-section"><h4>Notalar</h4><p>${scaleNotes.map(n => noteNames[n] || n).join(' - ')}</p></div>
            <div class="result-section"><h4>Aralık Formülü (Tam-Yarım Ses)</h4><p>${scale.intervalStr}</p></div>
            <div class="result-section">
                <h4>Uyumlu Akorlar</h4>
                <div class="chords-container">
                    ${diatonicChords.length > 0 ? diatonicChords.map(c => {
                        const chordName = c.split(': ')[1];
                        return `<button class="chord-box" onclick="showChordDiagram('${chordName}')">${c}</button>`;
                    }).join('') : '<p>Bu gam için standart diyatonik akorlar belirtilmemiştir.</p>'}
                </div>
            </div>
            <div class="result-section">
                <h4>Gitar Tabları (Taşınabilir Kalıp)</h4>
                <p>Bu tablar taşınabilir kalıplardır. Kök ses (R) olarak belirtilen notayı seçtiğiniz notaya denk getirerek çalabilirsiniz.</p>
                <pre>${scale.tab}</pre>
            </div>
        `;
        resultsDiv.style.display = 'block';
        resultsDiv.scrollIntoView({ behavior: 'smooth' });
    }

    function populateScaleList(scaleKeys) {
        scaleList.innerHTML = '';
        scaleKeys.forEach(key => {
            const button = document.createElement('button');
            button.className = 'scale-item';
            button.textContent = scaleData[key].name;
            button.onclick = () => displayScaleDetails(key);
            scaleList.appendChild(button);
        });
        scaleListContainer.style.display = 'block';
    }

    // --- Chord Modal Functions ---
    function showChordDiagram(chordName) {
        const fingering = chordFingerings[chordName];
        modalChordName.textContent = chordName;
        if (fingering) {
            modalChordDiagram.textContent = generateDiagram(fingering);
        } else {
            modalChordDiagram.textContent = 'Bu akor için şema bulunamadı.';
        }
        chordModal.style.display = 'flex';
    }

    function closeChordModal() {
        chordModal.style.display = 'none';
    }

    function generateDiagram(fingering) {
        // Akor parmak dizilimi EADGBe (kalından inceye) sırasındadır.
        // Şema ise eBGDAE (inceden kalına) gösterilmelidir.
        const strings = ['e', 'B', 'G', 'D', 'A', 'E']; // Gösterim sırası: ince tel üstte
        const frets = fingering.split('').map(f => (f.toLowerCase() === 'x' ? 'x' : parseInt(f, 10)));
        
        let diagram = '';
        const fretNumbers = frets.filter(f => typeof f === 'number' && f > 0);
        const maxFret = fretNumbers.length > 0 ? Math.max(...fretNumbers) : 0;
        
        let startFret = 1;
        if (maxFret > 4) {
            startFret = Math.min(...fretNumbers);
        }
        const numFretsToShow = 5;

        if (startFret > 1) {
            diagram += `    (Perde ${startFret})\n`;
        }

        // Şemayı inceden kalına doğru (e, B, G, D, A, E) oluştur
        for (let i = 0; i < 6; i++) {
            diagram += `${strings[i]}|`;
            // frets dizisi kalından inceye (EADGBe) olduğu için,
            // ince 'e' teli (i=0) için frets[5]'e bakmalıyız.
            const fret = frets[5 - i]; // DÜZELTİLMİŞ KISIM

            if (fret === 'x') {
                diagram += '--X--|';
            } else if (fret === 0) {
                diagram += '-O---|'; // O for open string
            } else {
                let line = '';
                for (let j = 0; j < numFretsToShow; j++) {
                    const currentFret = startFret + j;
                    if (currentFret === fret) {
                        line += `-${'●'}-|`; // ● for fretted note
                    } else {
                        line += '---|';
                    }
                }
                diagram = diagram + line;
            }
            diagram += '\n';
        }
        diagram += "\n    X: Teli sustur\n    O: Teli açık çal\n    ●: Perdeye bas";
        return diagram;
    }


    // --- Initial Setup ---
    notes.forEach(note => {
        const button = document.createElement('button');
        button.className = 'btn';
        button.textContent = noteNames[note];
        button.dataset.note = note;
        button.onclick = () => {
            document.querySelectorAll('#note-selector .btn').forEach(b => b.classList.remove('active'));
            button.classList.add('active');
            selectedNote = note;
            resultsDiv.style.display = 'none';
            const currentMood = moodSelector.value;
            if (currentMood) {
                populateScaleList(moods[currentMood]);
            } else {
                populateScaleList(Object.keys(scaleData));
            }
        };
        noteSelector.appendChild(button);
    });

    Object.keys(moods).sort().forEach(mood => {
        const option = document.createElement('option');
        option.value = mood;
        option.textContent = mood;
        moodSelector.appendChild(option);
    });

    moodSelector.onchange = () => {
        const selectedMood = moodSelector.value;
        if (selectedMood) {
             if (!selectedNote) {
                alert("Lütfen önce bir kök nota seçin. Duyguya göre filtrelemek için bir başlangıç notası gereklidir.");
                moodSelector.value = '';
                return;
            }
            resultsDiv.style.display = 'none';
            populateScaleList(moods[selectedMood]);
        } else if (selectedNote) {
            resultsDiv.style.display = 'none';
            populateScaleList(Object.keys(scaleData));
        }
    };
</script>

</body>
</html>
